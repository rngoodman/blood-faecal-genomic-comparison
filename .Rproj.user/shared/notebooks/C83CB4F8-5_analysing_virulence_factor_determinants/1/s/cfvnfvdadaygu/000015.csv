"0",""
"0","rm_duplicates = function(ab_tab)"
"0","{"
"0","  "
"0","  # First Remove duplicates"
"0","  # These cause issues with creating a lit rather than a dataframe"
"0","  # When compared against the database there can sometimes be duplciates "
"0","  "
"0","  # arrange and group by ab_tab "
"0","  ab_tab_unique <- ab_tab %>% "
"0","    arrange(GENE, -`%COVERAGE`) %>% "
"0","    group_by(GENE)"
"0","  "
"0","  # Check the colnames"
"0","  colnames(ab_tab_unique)"
"0","  "
"0","  # Check the duplicates "
"0","  duplicated(ab_tab_unique[c(""#FILE"",""GENE"")])"
"0","  print(""Duplicates found:"")"
"0","  print(c(which(duplicated(ab_tab_unique[c(""#FILE"",""GENE"")]) == TRUE))) # see which contain duplicates"
"0","  "
"0","  # Remove columns that contain duplicates in FILE, GENE and COVERAGE "
"0","  ab_tab_unique <- ab_tab[!duplicated(ab_tab_unique[c(""#FILE"",""GENE"")]),] #using colnames"
"0","  #ab_tab_unique <- ab_tab_unique[!duplicated(ab_tab_unique[c(1,2)]),] #using col numbers"
"0","  "
"0","  "
"0","  # Check whether duplicates have been delted "
"0","  print(""Duplicates remaining:"")"
"0","  print(which(duplicated(ab_tab_unique[c(""#FILE"",""GENE"")]) == TRUE)) # see which contain duplicates"
"0","  "
"0","  {"
"0","    return(ab_tab_unique)"
"0","  }"
"0","}"
"0",""
"0",""
"0","# Run function "
"0","ab_tab_unique = rm_duplicates(ab_tab)"
"1","[1]"
"1"," ""Duplicates found:"""
"1","
"
"1"," [1]"
"1"," 404"
"1"," 405"
"1"," 406"
"1"," 407"
"1"," 408"
"1"," 409"
"1"," 410"
"1"," 411"
"1"," 412"
"1"," 413"
"1"," 414"
"1"," 415"
"1"," 416"
"1"," 417"
"1"," 418"
"1"," 419"
"1"," 420"
"1"," 421"
"1","
"
"1","[1]"
"1"," ""Duplicates remaining:"""
"1","
"
"1"," [1]"
"1"," 724"
"1"," 728"
"1"," 729"
"1"," 733"
"1"," 734"
"1"," 736"
"1"," 740"
"1"," 741"
"1"," 745"
"1"," 748"
"1"," 749"
"1"," 751"
"1"," 752"
"1"," 754"
"1"," 757"
"1"," 758"
"1"," 760"
"1"," 764"
"1","
"
"0","mk_count_table = function(ab_tab)"
"0","{"
"0","  # Funtion to make the Abricate table wide "
"0","  # Create a new value from original ab_tab to wide count table "
"0","  wide = ab_tab %>% "
"0","    # select strain, gene and resistance and rename"
"0","    select(""#FILE"", GENE, RESISTANCE) %>% "
"0","    # rename "
"0","    dplyr::rename(gene = ""GENE"","
"0","           file = ""#FILE"","
"0","           resistance = ""RESISTANCE"") %>% "
"0","    # count genes vs strains"
"0","    count(file, gene) %>% "
"0","    # Convert to wide table with genes as column headers and n as values "
"0","    pivot_wider(names_from = gene,"
"0","                values_from = n)"
"0","  "
"0","  # Shorten strain names (remove the unnecessary string)"
"0","  wide$file = gsub("".fa"", """", wide$file)"
"0","  wide$file = gsub(""_assembled.fasta"", """", wide$file)"
"0",""
"0","  "
"0","  {"
"0","    return(wide)"
"0","  }"
"0","}"
"0",""
"0","# Run function "
"0","wide = mk_count_table(ab_tab_unique)"
"0",""
"0","wide$file"
"1"," [1]"
"1"," ""FSBL0558_hybractersta"" "
"1"," ""FSBL1386_hybractersta"" "
"1"," ""FSBL1448_flyesta""      "
"1"," ""FSBL1654_hybractersta"" "
"1"," ""FSBL1925_hybractersta"" "
"1"," ""FSBL2071_hybractersta"" "
"1","
"
"1"," [7]"
"1"," ""FSBL2111_hybractersta"" "
"1"," ""FSBL2112_hybractersta"" "
"1"," ""FSBL2130_hybractersta"" "
"1"," ""FSBL2155_hybractersta"" "
"1"," ""FSBL2240_hybractersta"" "
"1"," ""FSBL2258_hybractersta"" "
"1","
"
"1","[13]"
"1"," ""FSBL2265_hybractersta"" "
"1"," ""FSFC0558_hybractersta"" "
"1"," ""FSFC1386_hybractersta"" "
"1"," ""FSFC1448_flyesta""      "
"1"," ""FSFC1654_unicyclersta"" "
"1"," ""FSFC1925_hybractersta"" "
"1","
"
"1","[19]"
"1"," ""FSFC2071_hybractersta"" "
"1"," ""FSFC2111K_hybractersta"""
"1"," ""FSFC2112_hybractersta"" "
"1"," ""FSFC2130_hybractersta"" "
"1"," ""FSFC2155_hybractersta"" "
"1"," ""FSFC2240_unicyclersta"" "
"1","
"
"1","[25]"
"1"," ""FSFC2258_hybractersta"" "
"1"," ""FSFC2265_hybractersta"" "
"1","
"
"0","wide$file <- gsub(""_hybractersta"", """", wide$file)"
"0","wide$file <- gsub(""_flyesta"", """", wide$file)"
"0","wide$file <- gsub(""_unicyclersta"", """", wide$file)"
"0",""
"0","wide$file"
"1"," [1]"
"1"," ""FSBL0558"" "
"1"," ""FSBL1386"" "
"1"," ""FSBL1448"" "
"1"," ""FSBL1654"" "
"1"," ""FSBL1925"" "
"1"," ""FSBL2071"" "
"1"," ""FSBL2111"" "
"1"," ""FSBL2112"" "
"1"," ""FSBL2130"" "
"1"," ""FSBL2155"" "
"1"," ""FSBL2240"" "
"1"," ""FSBL2258"" "
"1"," ""FSBL2265"" "
"1"," ""FSFC0558"" "
"1","
"
"1","[15]"
"1"," ""FSFC1386"" "
"1"," ""FSFC1448"" "
"1"," ""FSFC1654"" "
"1"," ""FSFC1925"" "
"1"," ""FSFC2071"" "
"1"," ""FSFC2111K"""
"1"," ""FSFC2112"" "
"1"," ""FSFC2130"" "
"1"," ""FSFC2155"" "
"1"," ""FSFC2240"" "
"1"," ""FSFC2258"" "
"1"," ""FSFC2265"" "
"1","
"
"0","# Check"
"0","head(wide)"
