"0","# Generate the heatmap with annotations"
"0",""
"0","isolates = read_csv(""data/Isolate_species.csv"")"
"0","  "
"0","isolates_df = as.data.frame(isolates)"
"0",""
"0","isolates_df = isolates_df[-1,]"
"0",""
"0","species_colors <- c(""K. pneumoniae"" = ""#DDAD3B"", "
"0","                    ""E. coli"" = ""#9F7831"","
"0","                    ""K. quasipneumoniae similipneumoniae"" = ""#666666"")"
"0",""
"0","# Annotation for isolates (y-axis)"
"0","annotation_row <- data.frame(Species = isolates_df$Species)"
"0","rownames(annotation_row) <- isolates_df$Isolate"
"0",""
"0","vfdb_class = read_csv(""data/VFDB_classes.csv"")"
"0",""
"0","vfdb_class_df = as.data.frame(vfdb_class)"
"0",""
"0","class_colors <- c(""Protectins"" = ""#4B9B7A"", "
"0","                  ""Toxins"" = ""#CA6728"", "
"0","                  ""Iron-uptake"" = ""#D43F88"", "
"0","                  ""Adhesins"" = ""#7470AF"")"
"0",""
"0",""
"0","# Annotation for isolates (x-axis)"
"0",""
"0","annotation_col <- data.frame(class = vfdb_class_df$class)"
"0","rownames(annotation_col) <- vfdb_class_df$GENE"
"0",""
"0","# Create a list of annotation colors"
"0","annotation_colors <- list(class = class_colors, Species = species_colors)"
"0",""
"0",""
"0","custom_colors <- colorRampPalette(c(""#FFFFFF"",""#FBF5BB"", ""#FADF9F"", ""#F8B877"", ""#D37A5A"", ""#A84451""))(6)"
"0",""
"0",""
"0","pheatmap(df, "
"0","         annotation_col = annotation_col, "
"0","         annotation_row = annotation_row, "
"0","         annotation_colors = annotation_colors, "
"0","         color = custom_colors,"
"0","         show_rownames = TRUE, "
"0","         show_colnames = TRUE,"
"0","         border_color = ""black"")"
