"0",""
"0","metadata = read_csv(""data/all_773_DASSIM_BSI_metadata.csv"")"
"0","BSI_metadata_Ec = read_csv(""data/BSI_metadata_Ec.csv"")"
"0","BSI_metadata_KpSc = read_csv(""data/BSI_metadata_KpSc_2.csv"")"
"0",""
"0","library(dplyr)"
"0","library(stringr)"
"0",""
"0","filtered_df <- d[, grepl(""ybt|fyu|irp"", colnames(d)), drop = FALSE]"
"0","filtered_df$seq <- rownames(filtered_df)"
"0",""
"0","filtered_df <- filtered_df %>%"
"0","  mutate(seq = gsub(""-"", ""_"", seq))"
"0",""
"0","rownames(filtered_df) = gsub(""-"", ""_"", rownames(filtered_df))"
"0",""
"0","# DASSIM	ERR3865256	28099_1_10	ERR3865256"
"0",""
"0","# Create a named vector for replacement"
"0","replacement_map <- setNames(metadata$ENA_accession, metadata$lane)"
"0",""
"0","# Perform the replacement"
"0","filtered_df <- filtered_df %>%"
"0","  mutate(accession = str_replace_all(seq, replacement_map) # Replace lanes with ENA accessions"
"0","  )"
"0",""
"0","comparison_df = data.frame(accession = metadata$ENA_accession, "
"0","                           lane = metadata$lane)"
"0",""
"0","# Add the accession column with conditional logic"
"0","filtered_df[,""accession""] <- ifelse("
"0","  grepl(""^E"", filtered_df[,""seq""]), # Check if seq starts with ""E"""
"0","  filtered_df[,""seq""], # If true, copy seq to accession"
"0","  comparison_df$accession[match(unlist(filtered_df[,""seq""]), comparison_df$lane)] # Otherwise, match and replace"
"0",")"
"0",""
"0","# View the results"
"0","print(filtered_df[""28099_1_10"",]) # Should be ERR3865256"
